<!doctype html>
<html lang="en">
<head>
    {% include 'head.jinja' %}
    <style>
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            grid-column-gap: 20px;
            grid-row-gap: 20px;
            justify-items: stretch;
            align-items: stretch;
        }

        @media (max-width: 1024px) {
            .grid-container {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 576px) {
            .grid-container {
                grid-template-columns: 1fr;
            }
        }

        .grid-element {
            min-height: 100px;
            border: solid 2px gray;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            padding: 10px;
        }

        .image-container {
            aspect-ratio: 1 / 1;
            width: 100%;
            position: relative;
            display: block;
            align-content: center;
            max-height: 100%;
        }
    </style>
</head>
<body>
<main class="container">
    {% include 'navbar.jinja' %}
    {% if login_success == True %}
        <div style="border-radius: 20px; padding: 10px; background-color: green;">
            <h3>Prijava je bila uspe≈°na</h3>
        </div>
    {% elif login_success == False %}
        <div style="border-radius: 20px; padding: 10px; background-color: #ED4337;">
            <h3>Te≈æave s prijavo</h3>
            Prosimo, poskusite znova!
        </div>
    {% endif %}
    <p></p>
    <div style="display: flex; flex-direction: row; justify-content: space-between;">
        {% if is_admin %}
            <a href="/admin/new_product">
                <button>Dodaj nov izdelek</button>
            </a>
        {% else %}
            <div></div>
        {% endif %}
        <div style="display: flex; flex-direction: column;">
            <form method="POST" action="{{ url_for('home') }}" id="sort-form">
                <select name="sorting_method" aria-label="Sortiraj" style="width: fit-content;" onchange="sort()">
                    <option value="" {% if sorting_method == "" %}selected{% endif %}>Nazadnje spremenjeno</option>
                    <option value="last-changed-asc" {% if sorting_method == "last-changed-asc" %}selected{% endif %}>
                        Najzadnje spremenjeno
                    </option>
                    <option value="created-desc" {% if sorting_method == "created-desc" %}selected{% endif %}>Nazadnje
                        ustvarjeno
                    </option>
                    <option value="created-asc" {% if sorting_method == "created-asc" %}selected{% endif %}>Najzadnje
                        ustvarjeno
                    </option>
                    <option value="alphabet-asc" {% if sorting_method == "alphabet-asc" %}selected{% endif %}>Abecedni
                        vrstni red
                    </option>
                    <option value="alphabet-desc" {% if sorting_method == "alphabet-desc" %}selected{% endif %}>
                        Padajoƒçi abecedni vrstni red
                    </option>
                    <option value="size-asc" {% if sorting_method == "size-asc" %}selected{% endif %}>
                        Nara≈°ƒçajoƒça velikost
                    </option>
                    <option value="size-desc" {% if sorting_method == "size-desc" %}selected{% endif %}>
                        Padajoƒça velikost
                    </option>
                </select>
                <details class="dropdown">
                    <summary>
                        Izberite filtre
                    </summary>
                    <ul style="padding: 0 10px;">
                        {% if is_admin %}
                            <span style="padding: 5px; font-weight: bold;">Stanja izdelkov:</span>
                            <li>
                                <label>
                                    <input type="checkbox" name="active" {% if filter_active %}checked{% endif %}/>
                                    Aktivno
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="archived" {% if filter_archived %}checked{% endif %}/>
                                    Arhivirano
                                </label>
                            </li>
                            <li>
                                <label>
                                    <input type="checkbox" name="draft" {% if filter_draft %}checked{% endif %}/>
                                    Osnutek
                                </label>
                            </li>
                        {% endif %}
                        {% if is_teacher or is_admin %}
                            <p></p>
                            <fieldset>
                                <label>
                                    <input name="teacher" type="checkbox" role="switch" {% if filter_teacher %}checked{% endif %} />
                                    Prika≈æi samo izdelke, prispevane s strani uƒçiteljev
                                </label>
                            </fieldset>
                        {% endif %}
                        <span style="padding: 5px; font-weight: bold;">Tipi izdelkov:</span>
                        <li>
                            <label>
                                <input type="checkbox" name="hat" {% if filter_hat %}checked{% endif %}/>
                                üß¢ Kapa
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="sunglasses" {% if filter_sunglasses %}checked{% endif %}/>
                                üï∂Ô∏è Sonƒçna oƒçala
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="men_shirts" {% if filter_men_shirts %}checked{% endif %}/>
                                üëï Mo≈°ke majice
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="women_shirts"
                                       {% if filter_women_shirts %}checked{% endif %}/>
                                üëö ≈Ωenske majice
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="men_pants" {% if filter_men_pants %}checked{% endif %}/>
                                üëñ Mo≈°ke hlaƒçe
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="women_pants"
                                       {% if filter_women_pants %}checked{% endif %}/>
                                üëñ ≈Ωenske hlaƒçe
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="men_shoes" {% if filter_men_shoes %}checked{% endif %}/>
                                üëû Mo≈°ki ƒçevlji
                            </label>
                        </li>
                        <li>
                            <label>
                                <input type="checkbox" name="women_shoes"
                                       {% if filter_women_shoes %}checked{% endif %}/>
                                ü•ø ≈Ωenski ƒçevlji
                            </label>
                        </li>
                        <button type="submit">Potrdi filtre</button>
                    </ul>
                </details>
            </form>
        </div>
    </div>
    {% if products|length > 0 %}
        <div class="grid-container">
            {% for product in products %}
                <div class="grid-element">
                    <div class="image-container">
                        <img alt="{{ product.description }}" src="/uploads/images/{{ product.default_image_id }}.png">
                    </div>
                    <div style="height: 10px"></div>
                    <h4><a href="{{ url_for('item_details', item_id=product.product_id) }}">{{ product.name }}</a></h4>
                    <h5>
                        {% if product.category == "hat" %}
                            üß¢ Kapa
                        {% elif product.category == "sunglasses" %}
                            üï∂Ô∏è Sonƒçna oƒçala
                        {% elif product.category == "men-shirts" %}
                            üëï Mo≈°ke majice {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% elif product.category == "women-shirts" %}
                            üëö ≈Ωenske majice {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% elif product.category == "men-pants" %}
                            üëñ Mo≈°ke hlaƒçe {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% elif product.category == "women-pants" %}
                            üëñ ≈Ωenske hlaƒçe {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% elif product.category == "men-shoes" %}
                            üëû Mo≈°ki ƒçevlji {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% elif product.category == "women-shoes" %}
                            ü•ø ≈Ωenski ƒçevlji {% if product.size != "" %}(velikosti {{ product.size }}){% endif %}
                        {% endif %}
                    </h5>
                    <div style="display: flex; flex-direction: row;">
                        <div style="border: solid 2px white; border-radius: 15px; min-width: 80px; width: 25%; height: 30px; display: flex; flex-direction: row;">
                            <div style="align-content: center; width: 100%;">
                                <div style="display: flex; flex-direction: row; padding: 0 5px; justify-content: space-between; width: 100%;">
                                    {% if product.state >= 100 %}
                                        <div style="background-color: var(--pico-primary-background); height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% else %}
                                        <div style="background-color: white; height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% endif %}
                                    {% if product.state >= 200 %}
                                        <div style="background-color: var(--pico-primary-background); height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% else %}
                                        <div style="background-color: white; height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% endif %}
                                    {% if product.state >= 300 %}
                                        <div style="background-color: var(--pico-primary-background); height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% else %}
                                        <div style="background-color: white; height: 20px; width: 20px; border-radius: 10px;"></div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div style="width: 10px;"></div>
                        {% if product.state == -1 %}
                            Neznano stanje
                        {% elif product.state == 100 %}
                            Dobro stanje
                        {% elif product.state == 200 %}
                            Zelo dobro stanje
                        {% elif product.state == 300 %}
                            Odliƒçno stanje
                        {% endif %}
                    </div>
                    {% if product.teacher and (is_teacher or is_admin) %}
                        <div style="height: 10px;"></div>
                        üßë‚Äçüè´ Izdelek je bil prispevan s strani uƒçitelja
                    {% endif %}
                    <p></p>
                    {% if is_admin %}
                        <div role="group">
                            <a href="{{ url_for('archive_product', product_id=product.product_id) }}">
                                <button style="width: 100%;">{% if product.archived %}Odarhiviraj{% else %}
                                    Arhiviraj{% endif %}</button>
                            </a>
                            <a href="{{ url_for('delete_product', product_id=product.product_id) }}">
                                <button style="width: 100%;" class="secondary">Izbri≈°i</button>
                            </a>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <span style="font-size: 5em; font-weight: bold;">(>_<)</span>
        <h3>Za va≈°e iskanje ni zadetkov.</h3>
    {% endif %}
</main>
</body>
<script>
    function sort() {
        console.log("sort")
        document.getElementById("sort-form").submit();
    }
</script>
</html>